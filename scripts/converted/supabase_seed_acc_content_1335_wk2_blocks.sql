-- supabase_seed_acc_content_1335_wk2.sql — Lesson: acc02b02-0000-0000-0000-000000000001
-- Converted from legacy HTML to structured lesson blocks
DELETE FROM lesson_blocks WHERE lesson_id = 'acc02b02-0000-0000-0000-000000000001';
INSERT INTO lesson_blocks (id, lesson_id, block_type, content, order_index, created_at, updated_at)
VALUES
  (gen_random_uuid(), 'acc02b02-0000-0000-0000-000000000001', 'text', '{"html":"<h2>Your First Hands-On Lab: Measuring Distances Electronically</h2><p>This week you move from the classroom to the field. You will set up a total station on a tripod, assemble a prism target, measure distances electronically, apply atmospheric corrections, and record everything in your field book. Electronic Distance Measurement (EDM) is the foundation of virtually all modern surveying — every traverse, boundary survey, and construction layout depends on accurate EDM distances.</p><p>By the end of this lab you should be able to set up, measure, correct, and record distances confidently and independently.</p>"}'::jsonb, 0, now(), now()),
  (gen_random_uuid(), 'acc02b02-0000-0000-0000-000000000001', 'text', '{"html":"<h2>How EDM Works</h2><p>An EDM measures distance by transmitting a <strong>modulated electromagnetic signal</strong> — typically infrared light — to a <strong>retroreflecting prism</strong> at the target point. The signal bounces back and the instrument measures the <strong>phase shift</strong> between the outgoing and returning waves. From the phase shift it computes the travel time and, knowing the speed of light in the atmosphere, derives the distance.</p>"}'::jsonb, 1, now(), now()),
  (gen_random_uuid(), 'acc02b02-0000-0000-0000-000000000001', 'text', '{"html":"<h3>The Measurement Process (Simplified)</h3><ol>\n<li>The EDM transmits an infrared beam modulated at a known frequency</li>\n<li>The beam travels to the prism and reflects directly back along the same path</li>\n<li>The instrument compares the phase of the returned signal to the transmitted signal</li>\n<li>The phase difference corresponds to a fraction of the modulation wavelength</li>\n<li>Multiple modulation frequencies are used to resolve the total number of whole wavelengths (the \"ambiguity\")</li>\n<li>The instrument reports the <strong>slope distance</strong> from the instrument to the prism</li>\n</ol><p>Modern EDMs in total stations can measure distances up to several kilometers with a single prism, and shorter distances (up to ~200 m) in \"reflectorless\" mode using the return from a solid surface.</p>"}'::jsonb, 2, now(), now()),
  (gen_random_uuid(), 'acc02b02-0000-0000-0000-000000000001', 'text', '{"html":"<h3>EDM Accuracy Specification</h3><p>EDM accuracy is expressed as <strong>±(a mm + b ppm)</strong>, where:</p><ul>\n<li><strong>a</strong> is the constant error (typically 1–3 mm) — independent of distance</li>\n<li><strong>b</strong> is the proportional error (typically 1–3 ppm) — grows with distance</li>\n</ul><p><strong>Example:</strong> An EDM rated at ±(2 mm + 2 ppm) measuring a distance of 500 m has an expected uncertainty of: 2 mm + (2 × 500/1,000,000 × 1,000,000 mm) = 2 mm + 1 mm = <strong>±3 mm</strong>.</p><p>For a 100 m distance: 2 mm + (2 × 0.1 mm) = <strong>±2.2 mm</strong>. The constant error dominates at short distances; the proportional error dominates at long distances.</p>"}'::jsonb, 3, now(), now()),
  (gen_random_uuid(), 'acc02b02-0000-0000-0000-000000000001', 'text', '{"html":"<h2>Setting Up the Equipment</h2>"}'::jsonb, 4, now(), now()),
  (gen_random_uuid(), 'acc02b02-0000-0000-0000-000000000001', 'text', '{"html":"<h3>Step 1: Tripod Setup</h3><p>You learned the tripod basics last week. Here is the full procedure you will execute today:</p><ol>\n<li><strong>Position the tripod</strong> over the station mark. Spread the legs to form a stable triangle with the head roughly level.</li>\n<li><strong>Push each leg</strong> firmly into the ground (or use a tripod pad on pavement). The instrument eyepiece should be at a comfortable viewing height.</li>\n<li><strong>Check that the head is roughly level</strong> by eye before mounting the instrument.</li>\n</ol>"}'::jsonb, 5, now(), now()),
  (gen_random_uuid(), 'acc02b02-0000-0000-0000-000000000001', 'text', '{"html":"<h3>Step 2: Mount the Tribrach and Instrument</h3><ol>\n<li>Attach the <strong>tribrach</strong> to the tripod head using the center bolt.</li>\n<li>Place the <strong>total station</strong> on the tribrach and engage the locking ring.</li>\n<li><strong>Rough-level</strong> using the circular bubble — adjust the tripod legs until the bubble is approximately centered.</li>\n<li><strong>Center over the mark</strong> using the optical plummet (or laser plummet). Look through the plummet eyepiece and slide the instrument on the tripod head until the crosshair is on the station mark.</li>\n<li><strong>Fine-level</strong> using the plate bubble and three leveling screws:\n  <ul>\n  <li>Rotate the instrument so the plate bubble is parallel to two of the leveling screws</li>\n  <li>Turn those two screws simultaneously in opposite directions until the bubble centers (the bubble follows your left thumb)</li>\n  <li>Rotate 90° and center the bubble with the third screw</li>\n  <li>Repeat until the bubble stays centered in all orientations</li>\n  </ul>\n</li>\n<li><strong>Re-check centering</strong> — fine-leveling often shifts the instrument slightly off center. Re-center over the mark and re-level. Iterate until both conditions are satisfied.</li>\n<li><strong>Measure and record HI</strong> (Height of Instrument) — the vertical distance from the ground mark to the trunnion axis.</li>\n</ol>"}'::jsonb, 6, now(), now()),
  (gen_random_uuid(), 'acc02b02-0000-0000-0000-000000000001', 'text', '{"html":"<h3>Step 3: Assemble the Prism Target</h3><ol>\n<li><strong>Thread the prism</strong> onto the prism holder/adapter.</li>\n<li><strong>Attach the prism holder</strong> to the top of the prism pole (range pole).</li>\n<li><strong>Set the prism pole height</strong> to match the HI if possible (this simplifies vertical angle computations), or to a convenient fixed height. Record the <strong>HR</strong> (Height of Reflector/Rod).</li>\n<li><strong>Check the prism constant</strong> label on the prism housing. Common values are 0 mm (Leica-style) or −30 mm (standard). Ensure the total station is set to the correct prism constant.</li>\n<li><strong>Level the prism pole</strong> using the attached circular bubble. The rod person must hold the pole plumb over the target point during every measurement.</li>\n</ol>"}'::jsonb, 7, now(), now()),
  (gen_random_uuid(), 'acc02b02-0000-0000-0000-000000000001', 'text', '{"html":"<h2>Measuring Distances</h2>"}'::jsonb, 8, now(), now()),
  (gen_random_uuid(), 'acc02b02-0000-0000-0000-000000000001', 'text', '{"html":"<h3>The Measurement Procedure</h3><ol>\n<li><strong>Power on</strong> the total station and enter or verify settings: units (meters or feet), atmospheric corrections (temperature and pressure), and prism constant.</li>\n<li><strong>Sight the prism.</strong> Use the sighting notch or red-dot finder on the instrument to roughly aim at the prism. Then look through the telescope and use the horizontal and vertical tangent screws to precisely center the crosshair on the prism.</li>\n<li><strong>Press the \"Measure\" button</strong> (or \"DIST\" key). The EDM fires and returns the slope distance, horizontal distance, and vertical difference. Most instruments display all three.</li>\n<li><strong>Record the reading</strong> in your field book: slope distance, horizontal distance, zenith angle, and any vertical difference.</li>\n<li><strong>Take at least three readings</strong> and verify they agree within the instrument''s specification. If one reading disagrees significantly, discard it and re-measure.</li>\n<li><strong>Compute the mean</strong> of the accepted readings.</li>\n</ol>"}'::jsonb, 9, now(), now()),
  (gen_random_uuid(), 'acc02b02-0000-0000-0000-000000000001', 'text', '{"html":"<h3>What the Instrument Reports</h3>"}'::jsonb, 10, now(), now()),
  (gen_random_uuid(), 'acc02b02-0000-0000-0000-000000000001', 'table', '{"headers":["Value","Symbol","Description"],"rows":[["Slope Distance","SD","The straight-line distance from instrument to prism along the line of sight"],["Horizontal Distance","HD","The distance projected onto a horizontal plane: HD = SD × sin(zenith angle)"],["Vertical Difference","VD","The elevation difference: VD = SD × cos(zenith angle) + HI − HR"],["Zenith Angle","ZA","The vertical angle from straight up (0°) to the line of sight (90° = horizontal)"]]}'::jsonb, 11, now(), now()),
  (gen_random_uuid(), 'acc02b02-0000-0000-0000-000000000001', 'text', '{"html":"<h2>Atmospheric Corrections</h2><p>The EDM computes distance based on the speed of its signal through the atmosphere. The speed of light in air depends on <strong>temperature</strong>, <strong>atmospheric pressure</strong>, and <strong>humidity</strong>. If conditions differ from the instrument''s standard reference (typically 15°C and 760 mmHg / 1013.25 hPa), the measured distance will have a systematic error.</p>"}'::jsonb, 12, now(), now()),
  (gen_random_uuid(), 'acc02b02-0000-0000-0000-000000000001', 'text', '{"html":"<h3>Why It Matters in Texas</h3><p>In central Texas:</p><ul>\n<li>Summer temperatures routinely reach <strong>38–42°C (100–108°F)</strong> — far above the 15°C standard</li>\n<li>Winter temperatures can drop to <strong>−5°C (23°F)</strong> during cold fronts</li>\n<li>Temperature swings of 20°C in a single day are common in spring and fall</li>\n</ul><p>At 38°C and standard pressure, the atmospheric correction is approximately <strong>+12 ppm</strong> compared to standard conditions. For a 1,000 m distance, that is <strong>+12 mm</strong>. For a 100 m distance, it is <strong>+1.2 mm</strong>. The correction is always positive in hot weather (the signal travels faster in warm air, so the uncorrected distance reads short).</p>"}'::jsonb, 13, now(), now()),
  (gen_random_uuid(), 'acc02b02-0000-0000-0000-000000000001', 'text', '{"html":"<h3>Applying the Correction</h3><p>Most modern total stations apply atmospheric corrections automatically when you enter the current temperature and pressure. You should:</p><ol>\n<li><strong>Measure temperature</strong> at the instrument with a thermometer. Do not use the forecast temperature — local conditions near the ground may differ significantly.</li>\n<li><strong>Measure pressure</strong> with a barometer or use the pressure from a nearby weather station, adjusted for elevation difference if needed.</li>\n<li><strong>Enter both values</strong> into the total station''s atmospheric correction settings.</li>\n<li><strong>Update periodically</strong> during long sessions — conditions change throughout the day.</li>\n</ol>"}'::jsonb, 14, now(), now()),
  (gen_random_uuid(), 'acc02b02-0000-0000-0000-000000000001', 'text', '{"html":"<h3>The Atmospheric Correction Formula</h3><p>The correction in parts per million (ppm) can be approximated by:</p><p style=\"text-align:center;\"><strong>C<sub>atm</sub> ≈ 281.8 − (79.661 × P) / (273.15 + T)</strong></p><p>where T is temperature in °C and P is pressure in hPa. The corrected distance is:</p><p style=\"text-align:center;\"><strong>D<sub>corrected</sub> = D<sub>measured</sub> × (1 + C<sub>atm</sub> / 1,000,000)</strong></p><p>You do not need to memorize this formula — the instrument handles it — but you should understand that the correction exists and can be significant in Texas conditions.</p>"}'::jsonb, 15, now(), now()),
  (gen_random_uuid(), 'acc02b02-0000-0000-0000-000000000001', 'text', '{"html":"<h2>The Prism Constant</h2><p>The EDM measures the distance to the <strong>optical center</strong> of the prism, not to the physical center of the prism pole. The difference between these two points is the <strong>prism constant</strong> (also called the prism offset).</p>"}'::jsonb, 16, now(), now()),
  (gen_random_uuid(), 'acc02b02-0000-0000-0000-000000000001', 'table', '{"headers":["Prism Type","Typical Constant","Notes"],"rows":[["Standard (most brands)","−30 mm","The optical center is 30 mm behind the physical face"],["Leica-style (360° prism)","0 mm","Designed for zero offset"],["Mini prism","−17.5 mm to 0 mm","Varies by model"]]}'::jsonb, 17, now(), now()),
  (gen_random_uuid(), 'acc02b02-0000-0000-0000-000000000001', 'text', '{"html":"<p><strong>Critical:</strong> The prism constant set in the total station must match the prism being used. If you use a standard −30 mm prism but the instrument is set to 0 mm, every distance will be <strong>30 mm too long</strong>. On a traverse with 10 legs, that is a cumulative error of 300 mm (about 1 foot) — enough to blow any precision requirement.</p>"}'::jsonb, 18, now(), now()),
  (gen_random_uuid(), 'acc02b02-0000-0000-0000-000000000001', 'text', '{"html":"<h2>Slope Distance vs. Horizontal Distance</h2><p>The EDM measures <strong>slope distance</strong> — the straight-line distance through the air from the instrument to the prism. For surveying computations, you almost always need the <strong>horizontal distance</strong>.</p><p>The conversion uses the zenith angle (ZA) measured by the vertical circle:</p><p style=\"text-align:center; font-size:1.1em;\"><strong>HD = SD × sin(ZA)</strong></p><p>where ZA is measured from the zenith (straight up = 0°, horizontal = 90°). Most total stations compute and display HD automatically.</p><p><strong>Example:</strong> SD = 215.482 m, ZA = 87°24′10″</p><p>HD = 215.482 × sin(87.4028°) = 215.482 × 0.99896 = <strong>215.258 m</strong></p><p>The difference (0.224 m ≈ 9 inches) matters. On steep terrain, the difference between slope and horizontal distance can be much larger.</p>"}'::jsonb, 19, now(), now()),
  (gen_random_uuid(), 'acc02b02-0000-0000-0000-000000000001', 'text', '{"html":"<h2>Recording EDM Measurements</h2><p>In your field book, record the following for each distance measurement:</p>"}'::jsonb, 20, now(), now()),
  (gen_random_uuid(), 'acc02b02-0000-0000-0000-000000000001', 'table', '{"headers":["Item","Example","Why"],"rows":[["From station","STA 1","Identifies the instrument position"],["To station","STA 2","Identifies the prism position"],["HI","1.523 m","Needed for elevation computation"],["HR (prism height)","1.800 m","Needed for elevation computation"],["Prism constant","−30 mm","Confirms correct setting"],["Temperature","34°C","For verifying atmospheric correction"],["Pressure","1008 hPa","For verifying atmospheric correction"],["SD (slope distance) — 3 readings","215.481, 215.483, 215.482","Redundancy and blunder check"],["Mean SD","215.482 m","Accepted value"],["ZA (zenith angle)","87°24′10″","For slope-to-horizontal conversion"],["HD (horizontal distance)","215.258 m","Used in computations"]]}'::jsonb, 21, now(), now()),
  (gen_random_uuid(), 'acc02b02-0000-0000-0000-000000000001', 'text', '{"html":"<h2>Common EDM Errors and How to Avoid Them</h2>"}'::jsonb, 22, now(), now()),
  (gen_random_uuid(), 'acc02b02-0000-0000-0000-000000000001', 'table', '{"headers":["Error","Cause","Prevention"],"rows":[["Wrong prism constant","Constant set for different prism type","Check the prism label and verify the total station setting before first measurement"],["Wrong atmospheric correction","Default values left in instrument; conditions changed","Measure and enter actual temperature and pressure; update during the day"],["Prism not plumb","Rod person not holding pole vertical","Use rod-level bubble; instrument operator should watch for leaning"],["Sighting wrong target","Multiple prisms in the area; reflective surfaces","Communicate with rod person; use only designated prism targets"],["Multipath interference","EDM beam reflects off nearby surfaces (vehicles, walls)","Ensure clear sightline; move instrument if readings are erratic"],["Heat shimmer","Atmospheric turbulence near hot ground surfaces","Raise sightline above ground; avoid low shots over pavement in afternoon"]]}'::jsonb, 23, now(), now()),
  (gen_random_uuid(), 'acc02b02-0000-0000-0000-000000000001', 'text', '{"html":"<h2>Today''s Lab Exercise</h2><p>You will measure a series of <strong>known distances</strong> on the campus baseline course — a set of permanently monumented points whose distances have been precisely determined by calibration. This allows you to:</p><ol>\n<li>Practice the complete setup and measurement procedure</li>\n<li>Verify that your instrument is reading correctly</li>\n<li>Experience the effect of atmospheric corrections firsthand</li>\n<li>Compare your measured distances to the known values</li>\n</ol><p>Your goal is to measure each baseline distance within <strong>±5 mm</strong> of the known value. If your measurements are consistently off by a similar amount, check your prism constant and atmospheric correction settings first.</p>"}'::jsonb, 24, now(), now()),
  (gen_random_uuid(), 'acc02b02-0000-0000-0000-000000000001', 'text', '{"html":"<h2>Looking Ahead</h2><p>Next week you will learn <strong>differential leveling</strong> — using an automatic level and leveling rod to determine elevation differences between points. EDM distances are horizontal; leveling gives you the vertical component. Together, they define three-dimensional positions.</p>"}'::jsonb, 25, now(), now());

-- Mark lesson as migrated (original HTML preserved as fallback)
UPDATE learning_lessons SET content_migrated = TRUE WHERE id = 'acc02b02-0000-0000-0000-000000000001';
